<?xml version='1.0' encoding='GBK' ?>
<!DOCTYPE ViewObject SYSTEM "jbo_03_01.dtd">

<ViewObject
   Name="ContractContentVO"
   BindingStyle="OracleName"
   CustomQuery="true"
   RowClass="cux.oracle.apps.per.review.server.ContractContentVORowImpl"
   ComponentClass="cux.oracle.apps.per.review.server.ContractContentVOImpl"
   FetchMode="FETCH_AS_NEEDED"
   UseGlueCode="false" >
   <SQLQuery><![CDATA[
SELECT A.CONTRACT_ID,
       A.APPRAISAL_ID,
       A.TMPL_ID,
       A.WEIGHT,
       A.TARGET_VALUE,
       A.MINIMUM_VALUE,
       A.RATING_METHOD,
       A.SHOW_SEQ,
       A.KPI_ID,
       A.KPI_AREA,
       A.KPI_AREA_meaning,
       A.KPI_NAME,
       A.KPI_DESC,
       A.KPI_CLASS,
       A.KPI_DATA_SOURCE,
       A.KPI_DATA_SOURCE_meaning,
       A.KPI_DATA_DIMENSION,
       A.KPI_SCORING_METHOD,
       A.KPI_SCORING_METHOD_meaning,
       A.ATTRIBUTE1,
       A.ATTRIBUTE2,
       A.ATTRIBUTE3,
       A.ATTRIBUTE4,
       A.ATTRIBUTE5,
       A.LAST_UPDATE_DATE,
       A.LAST_UPDATED_BY,
       A.LAST_UPDATE_LOGIN,
       A.CREATED_BY,
       A.CREATION_DATE,
       A.ACTUAL_VALUE,
       A.SCORE_VALUE,
       A.SELF_EVAL_VALUE,
       A.ACTUAL_VALUE_SHOW,
       decode(A.KPI_DATA_SOURCE,
              '-1',
              cux_jxkh_common_pkg.cal_kpi_scorevalue(A.CONTRACT_ID,
                                                     A.ACTUAL_VALUE_SHOW,a.sign_date),
              NULL) AS SCORE_VALUE_SHOW,
       A.PARENT_CONTRACT_ID,
       A.UPDATE_IMAGE,
       A.DELETE_IMAGE,
       A.actual_value_link,
       A.kpi_data_source_display
  FROM (with zcx as 
           (SELECT ContractEO.CONTRACT_ID,
               ContractEO.APPRAISAL_ID,
               ContractEO.TMPL_ID,
               ContractEO.WEIGHT,
               ContractEO.TARGET_VALUE,
               ContractEO.MINIMUM_VALUE,
               ContractEO.RATING_METHOD,
               ContractEO.SHOW_SEQ,
               ContractEO.KPI_ID,
               ContractEO.KPI_AREA,
               nvl(lv1.meaning, ContractEO.KPI_AREA) AS KPI_AREA_meaning,
               ContractEO.KPI_NAME,
               ContractEO.KPI_DESC,
               ContractEO.KPI_CLASS,
               ContractEO.KPI_DATA_SOURCE,
               nvl(ds.epm_ds_name, ContractEO.KPI_DATA_SOURCE) AS KPI_DATA_SOURCE_meaning,
               ContractEO.KPI_DATA_DIMENSION,
               ContractEO.KPI_SCORING_METHOD,
               nvl(lv.meaning, ContractEO.KPI_SCORING_METHOD) AS KPI_SCORING_METHOD_meaning,
               ContractEO.ATTRIBUTE1,
               ContractEO.ATTRIBUTE2,
               ContractEO.ATTRIBUTE3,
               ContractEO.ATTRIBUTE4,
               ContractEO.ATTRIBUTE5,
               ContractEO.LAST_UPDATE_DATE,
               ContractEO.LAST_UPDATED_BY,
               ContractEO.LAST_UPDATE_LOGIN,
               ContractEO.CREATED_BY,
               ContractEO.CREATION_DATE,
               ContractEO.ACTUAL_VALUE,
               ContractEO.SCORE_VALUE,
               ContractEO.SELF_EVAL_VALUE,
               NVL(cat.sign_date,SYSDATE) sign_date,
               /*decode(ContractEO.KPI_DATA_SOURCE
                            , '-1'
                            , nvl(cux_jxkh_common_pkg.cal_kpi_actualvalue(ContractEO.APPRAISAL_ID,ContractEO.KPI_ID),ContractEO.ACTUAL_VALUE)
                            , ContractEO.ACTUAL_VALUE)*/
                            TO_NUMBER(decode(ContractEO.KPI_DATA_SOURCE,
                                   '-1',
                                   decode(cat.phase_id,
                                          'GOAL',
                                          decode(cat.status_id,
                                                 'COMPLETED',
                                                 decode(nvl(fnd_profile.VALUE('CUX_EPM_CAL_SCORE_FLAG'),
                                                            'Y'),
                                                        'N',
                                                        NULL,
                                                        cux_jxkh_common_pkg.cal_kpi_actualvalue(ContractEO.APPRAISAL_ID,
                                                                                                ContractEO.KPI_ID,NVL(cat.sign_date,SYSDATE))),
                                                 NULL),
                                          ContractEO.Actual_Value),
                                   NULL)
                             )
                AS ACTUAL_VALUE_SHOW
               /*decode(ContractEO.KPI_DATA_SOURCE
                            , '-1'
                            , cux_jxkh_common_pkg.cal_kpi_scorevalue(ContractEO.CONTRACT_ID,ContractEO.APPRAISAL_ID,ContractEO.KPI_ID)
                            , ContractEO.SCORE_VALUE)*/
               
              ,
               ContractEO.PARENT_CONTRACT_ID,
               decode(ContractEO.KPI_DATA_SOURCE,
                      '-1',
                      'UpdateDisabled',
                      decode(cux_jxkh_workflow_set_pkg.is_kpi_stdadd(ContractEO.KPI_CLASS),
                             'N',
                             'UpdateDisabled',
                             'UpdateEnabled')) AS UPDATE_IMAGE,
               decode(cux_jxkh_common_pkg.get_kpi_update_flag(ContractEO.APPRAISAL_ID,
                                                              ContractEO.KPI_CLASS),
                      'Y',
                      decode(cux_jxkh_common_pkg.is_present_performer(ContractEO.APPRAISAL_ID),
                             'N',
                             'DeleteDisabled',
                             'Y',
                             'DeleteEnabled',
                             'DeleteDisabled'),
                      'DeleteDisabled') AS DELETE_IMAGE,
               nvl2(cux_jxkh_common_pkg.get_constraint_id(cat.appraisal_person_id,
                                                          ContractEO.Kpi_Id,NVL(cat.sign_date,SYSDATE)),
                    'OA.jsp?page=/cux/oracle/apps/per/review/webui/KpiRptPG&APPRAISAL_ID=' ||
                    ContractEO.Appraisal_Id || '&KPI_ID=' ||
                    ContractEO.Kpi_Id || '&retainAM=Y&addBreadCrumb=Y',
                    null) actual_value_link,
               decode(ContractEO.Kpi_Data_Source,'-1',
                      nvl2(cux_jxkh_common_pkg.get_constraint_id(cat.appraisal_person_id,ContractEO.Kpi_Id,NVL(cat.sign_date,SYSDATE)),ds.epm_ds_name,'ÊÖ¹¤'),
                      ds.epm_ds_name
               ) kpi_data_source_display
          FROM CUX_CONTRACT_T    ContractEO,
               fnd_lookup_values lv,
               cux_data_source_v ds,
               fnd_lookup_values lv1,
               cux_appraisal_t   cat
        
         WHERE ContractEO.appraisal_id = cat.appraisal_id
           AND ContractEO.KPI_SCORING_METHOD = lv.lookup_code(+)
           AND lv.lookup_type(+) = 'EPM_SCORING_METHOD'
           AND lv.LANGUAGE(+) = userenv('LANG')
           AND nvl(lv.start_date_active(+), SYSDATE) <= SYSDATE
           AND nvl(lv.end_date_active(+), SYSDATE) >= SYSDATE
           AND ContractEO.KPI_DATA_SOURCE = ds.epm_ds_code(+)
           AND ContractEO.KPI_AREA = lv1.lookup_code(+)
           AND lv1.lookup_type(+) = 'EPM_INDICATOR_LEVEL'
           AND lv1.LANGUAGE(+) = userenv('LANG')
           AND nvl(lv1.start_date_active(+), SYSDATE) <= SYSDATE
           AND nvl(lv1.end_date_active(+), SYSDATE) >= SYSDATE
         ) select * from zcx
       ) A
   ]]></SQLQuery>
   <DesignTime>
      <Attr Name="_isCodegen" Value="true" />
      <Attr Name="_isExpertMode" Value="true" />
      <Attr Name="_version" Value="10.1.3.41.57" />
      <Attr Name="_codeGenFlag2" Value="Access|Coll|VarAccess" />
   </DesignTime>
   <EntityUsage
      Name="ContractEO"
      Entity="cux.oracle.apps.per.review.server.ContractEO" >
      <DesignTime>
         <Attr Name="_queryClause" Value="false" />
      </DesignTime>
   </EntityUsage>
   <ViewAttribute
      Name="ContractId"
      IsNotNull="true"
      EntityAttrName="ContractId"
      EntityUsage="ContractEO"
      AliasName="CONTRACT_ID" >
   </ViewAttribute>
   <ViewAttribute
      Name="AppraisalId"
      EntityAttrName="AppraisalId"
      EntityUsage="ContractEO"
      AliasName="APPRAISAL_ID" >
   </ViewAttribute>
   <ViewAttribute
      Name="TmplId"
      EntityAttrName="TmplId"
      EntityUsage="ContractEO"
      AliasName="TMPL_ID" >
   </ViewAttribute>
   <ViewAttribute
      Name="Weight"
      EntityAttrName="Weight"
      EntityUsage="ContractEO"
      AliasName="WEIGHT" >
   </ViewAttribute>
   <ViewAttribute
      Name="TargetValue"
      EntityAttrName="TargetValue"
      EntityUsage="ContractEO"
      AliasName="TARGET_VALUE" >
   </ViewAttribute>
   <ViewAttribute
      Name="MinimumValue"
      EntityAttrName="MinimumValue"
      EntityUsage="ContractEO"
      AliasName="MINIMUM_VALUE" >
   </ViewAttribute>
   <ViewAttribute
      Name="RatingMethod"
      EntityAttrName="RatingMethod"
      EntityUsage="ContractEO"
      AliasName="RATING_METHOD" >
   </ViewAttribute>
   <ViewAttribute
      Name="ShowSeq"
      EntityAttrName="ShowSeq"
      EntityUsage="ContractEO"
      AliasName="SHOW_SEQ" >
   </ViewAttribute>
   <ViewAttribute
      Name="KpiId"
      EntityAttrName="KpiId"
      EntityUsage="ContractEO"
      AliasName="KPI_ID" >
   </ViewAttribute>
   <ViewAttribute
      Name="KpiArea"
      EntityAttrName="KpiArea"
      EntityUsage="ContractEO"
      AliasName="KPI_AREA" >
   </ViewAttribute>
   <ViewAttribute
      Name="KpiAreaMeaning"
      IsPersistent="false"
      Precision="150"
      Type="java.lang.String"
      ColumnType="VARCHAR2"
      AliasName="KPI_AREA_MEANING"
      Expression="KPI_AREA_MEANING"
      SQLType="VARCHAR" >
      <DesignTime>
         <Attr Name="_DisplaySize" Value="150" />
      </DesignTime>
   </ViewAttribute>
   <ViewAttribute
      Name="KpiName"
      EntityAttrName="KpiName"
      EntityUsage="ContractEO"
      AliasName="KPI_NAME" >
   </ViewAttribute>
   <ViewAttribute
      Name="KpiDesc"
      EntityAttrName="KpiDesc"
      EntityUsage="ContractEO"
      AliasName="KPI_DESC" >
   </ViewAttribute>
   <ViewAttribute
      Name="KpiClass"
      EntityAttrName="KpiClass"
      EntityUsage="ContractEO"
      AliasName="KPI_CLASS" >
   </ViewAttribute>
   <ViewAttribute
      Name="KpiDataSource"
      EntityAttrName="KpiDataSource"
      EntityUsage="ContractEO"
      AliasName="KPI_DATA_SOURCE" >
   </ViewAttribute>
   <ViewAttribute
      Name="KpiDataSourceMeaning"
      IsPersistent="false"
      Precision="240"
      Type="java.lang.String"
      ColumnType="VARCHAR2"
      AliasName="KPI_DATA_SOURCE_MEANING"
      Expression="KPI_DATA_SOURCE_MEANING"
      SQLType="VARCHAR" >
      <DesignTime>
         <Attr Name="_DisplaySize" Value="240" />
      </DesignTime>
   </ViewAttribute>
   <ViewAttribute
      Name="KpiDataDimension"
      EntityAttrName="KpiDataDimension"
      EntityUsage="ContractEO"
      AliasName="KPI_DATA_DIMENSION" >
   </ViewAttribute>
   <ViewAttribute
      Name="KpiScoringMethod"
      EntityAttrName="KpiScoringMethod"
      EntityUsage="ContractEO"
      AliasName="KPI_SCORING_METHOD" >
   </ViewAttribute>
   <ViewAttribute
      Name="KpiScoringMethodMeaning"
      IsPersistent="false"
      Precision="150"
      Type="java.lang.String"
      ColumnType="VARCHAR2"
      AliasName="KPI_SCORING_METHOD_MEANING"
      Expression="KPI_SCORING_METHOD_MEANING"
      SQLType="VARCHAR" >
      <DesignTime>
         <Attr Name="_DisplaySize" Value="150" />
      </DesignTime>
   </ViewAttribute>
   <ViewAttribute
      Name="Attribute1"
      EntityAttrName="Attribute1"
      EntityUsage="ContractEO"
      AliasName="ATTRIBUTE1" >
   </ViewAttribute>
   <ViewAttribute
      Name="Attribute2"
      EntityAttrName="Attribute2"
      EntityUsage="ContractEO"
      AliasName="ATTRIBUTE2" >
   </ViewAttribute>
   <ViewAttribute
      Name="Attribute3"
      EntityAttrName="Attribute3"
      EntityUsage="ContractEO"
      AliasName="ATTRIBUTE3" >
   </ViewAttribute>
   <ViewAttribute
      Name="Attribute4"
      EntityAttrName="Attribute4"
      EntityUsage="ContractEO"
      AliasName="ATTRIBUTE4" >
   </ViewAttribute>
   <ViewAttribute
      Name="Attribute5"
      EntityAttrName="Attribute5"
      EntityUsage="ContractEO"
      AliasName="ATTRIBUTE5" >
   </ViewAttribute>
   <ViewAttribute
      Name="LastUpdateDate"
      EntityAttrName="LastUpdateDate"
      EntityUsage="ContractEO"
      AliasName="LAST_UPDATE_DATE" >
   </ViewAttribute>
   <ViewAttribute
      Name="LastUpdatedBy"
      EntityAttrName="LastUpdatedBy"
      EntityUsage="ContractEO"
      AliasName="LAST_UPDATED_BY" >
   </ViewAttribute>
   <ViewAttribute
      Name="LastUpdateLogin"
      EntityAttrName="LastUpdateLogin"
      EntityUsage="ContractEO"
      AliasName="LAST_UPDATE_LOGIN" >
   </ViewAttribute>
   <ViewAttribute
      Name="CreatedBy"
      EntityAttrName="CreatedBy"
      EntityUsage="ContractEO"
      AliasName="CREATED_BY" >
   </ViewAttribute>
   <ViewAttribute
      Name="CreationDate"
      EntityAttrName="CreationDate"
      EntityUsage="ContractEO"
      AliasName="CREATION_DATE" >
   </ViewAttribute>
   <ViewAttribute
      Name="ActualValue"
      EntityAttrName="ActualValue"
      EntityUsage="ContractEO"
      AliasName="ACTUAL_VALUE" >
   </ViewAttribute>
   <ViewAttribute
      Name="ScoreValue"
      EntityAttrName="ScoreValue"
      EntityUsage="ContractEO"
      AliasName="SCORE_VALUE" >
   </ViewAttribute>
   <ViewAttribute
      Name="SelfEvalValue"
      EntityAttrName="SelfEvalValue"
      EntityUsage="ContractEO"
      AliasName="SELF_EVAL_VALUE" >
   </ViewAttribute>
   <ViewAttribute
      Name="ActualValueShow"
      IsPersistent="false"
      Type="oracle.jbo.domain.Number"
      ColumnType="NUMBER"
      AliasName="ACTUAL_VALUE_SHOW"
      Expression="ACTUAL_VALUE_SHOW"
      SQLType="NUMERIC" >
      <DesignTime>
         <Attr Name="_DisplaySize" Value="22" />
      </DesignTime>
   </ViewAttribute>
   <ViewAttribute
      Name="ScoreValueShow"
      IsPersistent="false"
      Type="oracle.jbo.domain.Number"
      ColumnType="NUMBER"
      AliasName="SCORE_VALUE_SHOW"
      Expression="SCORE_VALUE_SHOW"
      SQLType="NUMERIC" >
      <DesignTime>
         <Attr Name="_DisplaySize" Value="22" />
      </DesignTime>
   </ViewAttribute>
   <ViewAttribute
      Name="ParentContractId"
      EntityAttrName="ParentContractId"
      EntityUsage="ContractEO"
      AliasName="PARENT_CONTRACT_ID" >
   </ViewAttribute>
   <ViewAttribute
      Name="UpdateImage"
      IsPersistent="false"
      Precision="14"
      Type="java.lang.String"
      ColumnType="VARCHAR2"
      AliasName="UPDATE_IMAGE"
      Expression="UPDATE_IMAGE"
      SQLType="VARCHAR" >
      <DesignTime>
         <Attr Name="_DisplaySize" Value="14" />
      </DesignTime>
   </ViewAttribute>
   <ViewAttribute
      Name="DeleteImage"
      IsPersistent="false"
      Precision="14"
      Type="java.lang.String"
      ColumnType="VARCHAR2"
      AliasName="DELETE_IMAGE"
      Expression="DELETE_IMAGE"
      SQLType="VARCHAR" >
      <DesignTime>
         <Attr Name="_DisplaySize" Value="14" />
      </DesignTime>
   </ViewAttribute>
   <ViewAttribute
      Name="ActualValueLink"
      IsPersistent="false"
      Precision="355"
      Type="java.lang.String"
      ColumnType="VARCHAR2"
      AliasName="actual_value_link"
      Expression="actual_value_link"
      SQLType="VARCHAR" >
   </ViewAttribute>
   <ViewAttribute
      Name="KpiDataSourceDisplay"
      IsPersistent="false"
      Precision="255"
      Type="java.lang.String"
      ColumnType="VARCHAR2"
      AliasName="KPI_DATA_SOURCE_DISPLAY"
      Expression="KPI_DATA_SOURCE_DISPLAY"
      SQLType="VARCHAR" >
   </ViewAttribute>
   <ViewAttribute
      Name="KpiDataDetails"
      IsPersistent="false"
      Precision="2"
      Type="java.lang.String"
      ColumnType="CHAR"
      AliasName="KPI_DATA_DETAILS"
      SQLType="VARCHAR" >
      <DesignTime>
         <Attr Name="_DisplaySize" Value="2" />
      </DesignTime>
   </ViewAttribute>
   <ViewLinkAccessor
      Name="ContractClassVO"
      ViewLink="cux.oracle.apps.per.review.server.ContractClassContentVL"
      Type="oracle.jbo.Row"
      Reversed="true"
      IsUpdateable="false" >
   </ViewLinkAccessor>
</ViewObject>
