package cux.oracle.apps.per.lov.server;

import cux.oracle.apps.per.poplist.server.KPIConJobVOImpl;

import cux.oracle.apps.per.poplist.server.KPIObjectClassVOImpl;

import java.sql.PreparedStatement;
import java.sql.ResultSet;

import java.sql.ResultSetMetaData;
import java.sql.Types;

import java.util.ArrayList;

import oracle.apps.fnd.framework.OAException;
import oracle.apps.fnd.framework.OAViewObject;
import oracle.apps.fnd.framework.server.OAApplicationModuleImpl;
import oracle.apps.fnd.framework.server.OADBTransactionImpl;
import oracle.apps.fnd.framework.server.OAViewDef;

import oracle.jbo.AttributeDef;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class PerLovAMImpl extends OAApplicationModuleImpl {
    /**This is the default constructor (do not remove)
     */
    public PerLovAMImpl() {
    }

    /**Sample main for debugging Business Components code using the tester.
     */
    public static void main(String[] args) { /* package name */
        /* Configuration Name */launchTester("cux.oracle.apps.per.lov.server", 
                                             "PerLovAMLocal");
    }

    /**Container's getter for PerOrganizationVO1
     */
    public PerOrganizationVOImpl getPerOrganizationVO1() {
        return (PerOrganizationVOImpl)findViewObject("PerOrganizationVO1");
    }

    /**Container's getter for PerJobVO1
     */
    public PerJobVOImpl getPerJobVO1() {
        return (PerJobVOImpl)findViewObject("PerJobVO1");
    }


    /**Container's getter for ContractVO1
     */
    public ContractVOImpl getContractVO1() {
        return (ContractVOImpl)findViewObject("ContractVO1");
    }

    /**Container's getter for PerVO1
     */
    public PerVOImpl getPerVO1() {
        return (PerVOImpl)findViewObject("PerVO1");
    }

    /**Container's getter for PerEmpVO1
     */
    public PerEmpVOImpl getPerEmpVO1() {
        return (PerEmpVOImpl)findViewObject("PerEmpVO1");
    }

    /**Container's getter for ValuesetVO1
     */
    public ValuesetVOImpl getValuesetVO1() {
        return (ValuesetVOImpl)findViewObject("ValuesetVO1");
    }

    /**Container's getter for OrganizationVO1
     */
    public OrganizationVOImpl getOrganizationVO1() {
        return (OrganizationVOImpl)findViewObject("OrganizationVO1");
    }

    /**Container's getter for WfStatusVO1
     */
    public WfStatusVOImpl getWfStatusVO1() {
        return (WfStatusVOImpl)findViewObject("WfStatusVO1");
    }

    /**Container's getter for KPIConJobVO1
     */
    public KPIConJobVOImpl getKPIConJobVO1() {
        return (KPIConJobVOImpl)findViewObject("KPIConJobVO1");
    }

    /**Container's getter for KPIObjectClassVO1
     */
    public KPIObjectClassVOImpl getKPIObjectClassVO1() {
        return (KPIObjectClassVOImpl)findViewObject("KPIObjectClassVO1");
    }

    /**Container's getter for KpiConJobLovVO1
     */
    public KpiConJobLovVOImpl getKpiConJobLovVO1() {
        return (KpiConJobLovVOImpl)findViewObject("KpiConJobLovVO1");
    }

    /**Container's getter for ValueSetDynVO1
     */
    public ValueSetDynVOImpl getValueSetDynVO1() {
        return (ValueSetDynVOImpl)findViewObject("ValueSetDynVO1");
    }


    public String getSQL(String arg1, OADBTransactionImpl odbt) {
        String sqlStr = null;
        PreparedStatement preparedStatement = null;
        ResultSet resultset = null;
        try {
            preparedStatement = 
                    odbt.createPreparedStatement("select cux_jx_utils.GET_VALUESET_SQL(?) from dual ", 
                                                 1);

            preparedStatement.setString(1, arg1);

            resultset = preparedStatement.executeQuery();
            if (resultset != null && resultset.next()) {
                sqlStr = resultset.getString(1);
            }
        } catch (Exception e) {
            throw OAException.wrapperException(e);

        } finally {
            try {
                if (preparedStatement != null) {

                    resultset.close();
                    preparedStatement.close();
                }
                return sqlStr;
            } catch (Exception e) {
                throw OAException.wrapperException(e);
            }
        }
    }

    public void dynamicVO(String arg1) {
        OADBTransactionImpl oadbtransactionimpl = 
            (OADBTransactionImpl)getOADBTransaction();
        PreparedStatement preparedstatement = null;
        ResultSet resultset = null;
        ResultSetMetaData rsmd = null;
        ArrayList list = null;
        String sqlStr = getSQL(arg1, oadbtransactionimpl);

        if (sqlStr == null) // null return;
            return;

        System.out.println(sqlStr);
        //create view object
        OAViewDef viewDef = oadbtransactionimpl.createViewDef();
        viewDef.setSql(sqlStr);
        viewDef.setExpertMode(true);
        viewDef.setViewObjectClass("oracle.apps.fnd.framework.server.OAViewObjectImpl");
        viewDef.setViewRowClass("oracle.apps.fnd.framework.server.OAViewRowImpl");
        //insert view object attribute

        viewDef.addSqlDerivedAttrDef("DisplayCol", "DISPLAY_COL", 
                                     "java.lang.String", Types.VARCHAR, true, 
                                     true, AttributeDef.READONLY);
        viewDef.addSqlDerivedAttrDef("ValueCol", "VALUE_COL", 
                                     "java.lang.String", Types.VARCHAR, true, 
                                     true, AttributeDef.READONLY);
        //insert end;
        OAViewObject vo = (OAViewObject)findViewObject("ValueSetDynVO1");
        if (vo != null) {
            vo.remove();
        }
        OAViewObject vo1 = 
            (OAViewObject)createViewObject("ValueSetDynVO1", viewDef);
        vo1.executeQuery();


    }

    /**Container's getter for PerKPITmpVO1
     */
    public PerKPITmpVOImpl getPerKPITmpVO1() {
        return (PerKPITmpVOImpl)findViewObject("PerKPITmpVO1");
    }

    /**Container's getter for PerKPIVO1
     */
    public PerKPIVOImpl getPerKPIVO1() {
        return (PerKPIVOImpl)findViewObject("PerKPIVO1");
    }

    /**Container's getter for PerKPITmp1VO1
     */
    public PerKPITmp1VOImpl getPerKPITmp1VO1() {
        return (PerKPITmp1VOImpl)findViewObject("PerKPITmp1VO1");
    }
}
