package cux.oracle.apps.per.bonus.specialawards.server;

import oracle.apps.fnd.framework.server.OAViewObjectImpl;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class SpecialAwardsSummaryVOImpl extends OAViewObjectImpl {
    /**This is the default constructor (do not remove)
     */
    public SpecialAwardsSummaryVOImpl() {
    }

    public void initSQL(String sqlDate, String bonusType) {
        StringBuffer sbfSQLValue = new StringBuffer(500);
        sbfSQLValue.append("SELECT DISTINCT (cd.dep_name),\n" + 
                           "                ct.type_name,\n" + 
                           "                NVL((SELECT SUM(cd1.distribution_amount)\n" + 
                           "                      FROM cux_bonus_dep_distribution cd1\n" + 
                           "                     WHERE cd1.type_id = cd.type_id\n" + 
                           "                       AND cd1.distribution_status IN\n" + 
                           "                           ('已批准')\n" + 
                           "                       AND cd1.dep_name = cd.dep_name\n" + 
                           "                       AND cd1.distribution_period = " + 
                           sqlDate + "01),\n" + 
                           "                    0) Jan,\n" + 
                           "                NVL((SELECT SUM(cd1.distribution_amount)\n" + 
                           "                      FROM cux_bonus_dep_distribution cd1\n" + 
                           "                     WHERE cd1.type_id = cd.type_id\n" + 
                           "                       AND cd1.distribution_status IN\n" + 
                           "                           ('已批准')\n" + 
                           "                       AND cd1.dep_name = cd.dep_name\n" + 
                           "                       AND cd1.distribution_period = " + 
                           sqlDate + "02),\n" + 
                           "                    0) Feb,\n" + 
                           "                NVL((SELECT SUM(cd1.distribution_amount)\n" + 
                           "                      FROM cux_bonus_dep_distribution cd1\n" + 
                           "                     WHERE cd1.type_id = cd.type_id\n" + 
                           "                       AND cd1.distribution_status IN\n" + 
                           "                           ('已批准')\n" + 
                           "                       AND cd1.dep_name = cd.dep_name\n" + 
                           "                       AND cd1.distribution_period = " + 
                           sqlDate + "03),\n" + 
                           "                    0) Mar,\n" + 
                           "                NVL((SELECT SUM(cd1.distribution_amount)\n" + 
                           "                      FROM cux_bonus_dep_distribution cd1\n" + 
                           "                     WHERE cd1.type_id = cd.type_id\n" + 
                           "                       AND cd1.distribution_status IN\n" + 
                           "                           ('已批准')\n" + 
                           "                       AND cd1.dep_name = cd.dep_name\n" + 
                           "                       AND cd1.distribution_period = " + 
                           sqlDate + "04),\n" + 
                           "                    0) Apr,\n" + 
                           "                NVL((SELECT SUM(cd1.distribution_amount)\n" + 
                           "                      FROM cux_bonus_dep_distribution cd1\n" + 
                           "                     WHERE cd1.type_id = cd.type_id\n" + 
                           "                       AND cd1.distribution_status IN\n" + 
                           "                           ('已批准')\n" + 
                           "                       AND cd1.dep_name = cd.dep_name\n" + 
                           "                       AND cd1.distribution_period = " + 
                           sqlDate + "05),\n" + 
                           "                    0) May,\n" + 
                           "                NVL((SELECT SUM(cd1.distribution_amount)\n" + 
                           "                      FROM cux_bonus_dep_distribution cd1\n" + 
                           "                     WHERE cd1.type_id = cd.type_id\n" + 
                           "                       AND cd1.distribution_status IN\n" + 
                           "                           ('已批准')\n" + 
                           "                       AND cd1.dep_name = cd.dep_name\n" + 
                           "                       AND cd1.distribution_period = " + 
                           sqlDate + "06),\n" + 
                           "                    0) Jun,\n" + 
                           "                NVL((SELECT SUM(cd1.distribution_amount)\n" + 
                           "                      FROM cux_bonus_dep_distribution cd1\n" + 
                           "                     WHERE cd1.type_id = cd.type_id\n" + 
                           "                       AND cd1.distribution_status IN\n" + 
                           "                           ('已批准')\n" + 
                           "                       AND cd1.dep_name = cd.dep_name\n" + 
                           "                       AND cd1.distribution_period = " + 
                           sqlDate + "07),\n" + 
                           "                    0) Jul,\n" + 
                           "                NVL((SELECT SUM(cd1.distribution_amount)\n" + 
                           "                      FROM cux_bonus_dep_distribution cd1\n" + 
                           "                     WHERE cd1.type_id = cd.type_id\n" + 
                           "                       AND cd1.distribution_status IN\n" + 
                           "                           ('已批准')\n" + 
                           "                       AND cd1.dep_name = cd.dep_name\n" + 
                           "                       AND cd1.distribution_period = " + 
                           sqlDate + "08),\n" + 
                           "                    0) Aug,\n" + 
                           "                NVL((SELECT SUM(cd1.distribution_amount)\n" + 
                           "                      FROM cux_bonus_dep_distribution cd1\n" + 
                           "                     WHERE cd1.type_id = cd.type_id\n" + 
                           "                       AND cd1.distribution_status IN\n" + 
                           "                           ('已批准')\n" + 
                           "                       AND cd1.dep_name = cd.dep_name\n" + 
                           "                       AND cd1.distribution_period = " + 
                           sqlDate + "09),\n" + 
                           "                    0) Sep,\n" + 
                           "                NVL((SELECT SUM(cd1.distribution_amount)\n" + 
                           "                      FROM cux_bonus_dep_distribution cd1\n" + 
                           "                     WHERE cd1.type_id = cd.type_id\n" + 
                           "                       AND cd1.distribution_status IN\n" + 
                           "                           ('已批准')\n" + 
                           "                       AND cd1.dep_name = cd.dep_name\n" + 
                           "                       AND cd1.distribution_period = " + 
                           sqlDate + "10),\n" + 
                           "                    0) Oct,\n" + 
                           "                NVL((SELECT SUM(cd1.distribution_amount)\n" + 
                           "                      FROM cux_bonus_dep_distribution cd1\n" + 
                           "                     WHERE cd1.type_id = cd.type_id\n" + 
                           "                       AND cd1.distribution_status IN\n" + 
                           "                           ('已批准')\n" + 
                           "                       AND cd1.dep_name = cd.dep_name\n" + 
                           "                       AND cd1.distribution_period = " + 
                           sqlDate + "11),\n" + 
                           "                    0) Nov,\n" + 
                           "                NVL((SELECT SUM(cd1.distribution_amount)\n" + 
                           "                      FROM cux_bonus_dep_distribution cd1\n" + 
                           "                     WHERE cd1.type_id = cd.type_id\n" + 
                           "                       AND cd1.distribution_status IN\n" + 
                           "                           ('已批准')\n" + 
                           "                       AND cd1.dep_name = cd.dep_name\n" + 
                           "                       AND cd1.distribution_period = " + 
                           sqlDate + "12),\n" + 
                           "                    0) Dec,\n" + 
                           "                NVL((SELECT SUM(cd1.distribution_amount)\n" + 
                           "                      FROM cux_bonus_dep_distribution cd1\n" + 
                           "                     WHERE cd1.type_id = cd.type_id\n" + 
                           "                       AND cd1.distribution_status IN\n" + 
                           "                           ('已批准')\n" + 
                           "                       AND cd1.dep_name = cd.dep_name\n" + 
                           "                       AND cd1.distribution_period BETWEEN " + 
                           sqlDate + "01 AND\n" + 
                           "                           " + sqlDate + "12),\n" + 
                           "                    0) Total,\n" + 
                           "               NVL((SELECT SUM(cd1.distribution_amount)\n" + 
                           "                       FROM cux_bonus_dep_distribution cd1\n" + 
                           "                      WHERE cd1.type_id = cd.type_id\n" + 
                           "                        AND cd1.distribution_status IN\n" + 
                           "                           ('已批准')\n" + 
                           "                        AND cd1.distribution_period BETWEEN " + 
                           sqlDate + "01 AND\n" + 
                           "                            " + sqlDate + 
                           "12),\n" + "                    0) DistTotal\n" + 
                           "  FROM cux_bonus_dep_distribution cd, cux_bonus_type ct\n" + 
                           " WHERE cd.type_id = ct.type_id\n" + 
                           "   AND cd.distribution_status IN ('已批准')\n" + 
                           "   AND cd.distribution_period BETWEEN " + sqlDate + 
                           "01 AND " + sqlDate + "12 AND ct.type_name = '" + 
                           bonusType + "' \n" + 
                           "ORDER BY NLSSORT(cd.dep_name, 'NLS_SORT=SCHINESE_PINYIN_M')");
        //        System.out.println(sbfSQLValue);       
        cancelQuery();
        setQuery(sbfSQLValue.toString());
        executeQuery();
        setMaxFetchSize(-1);
    }
}
