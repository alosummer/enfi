package cux.oracle.apps.per.bonus.awardsreport.server;

import oracle.apps.fnd.framework.server.OAViewObjectImpl;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class PersonDistDetailsVOImpl extends OAViewObjectImpl {
    /**This is the default constructor (do not remove)
     */
    public PersonDistDetailsVOImpl() {
    }

    public void initSQL(String employeeNumber, String queryYear) {
        StringBuffer sbfSQLValue = new StringBuffer(1000);
        sbfSQLValue.append("SELECT DISTINCT (CBT.TYPE_NAME),\n" + 
                           "                PAPF.EMPLOYEE_NUMBER,\n" + 
                           "                PAPF.LAST_NAME,\n" + 
                           "                DECODE(CBPD.PROJECT_ID,\n" + 
                           "                       0,\n" + 
                           "                       CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                       (SELECT PPA.NAME\n" + 
                           "                          FROM APPS.PA_PROJECTS_ALL PPA\n" + 
                           "                         WHERE PPA.PROJECT_ID = CBPD.PROJECT_ID)) AS AWARDS_SOURCE,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-01',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') AS JAN_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-02',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') AS FEB_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-03',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') AS MAR_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-04',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') AS APR_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-05',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') AS MAY_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-06',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') AS JUN_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-07',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') AS JUL_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-08',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') AS AUG_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-09',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') AS SEP_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-10',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') AS OCT_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-11',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') AS NOV_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-12',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') AS DEC_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-01',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') +\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-02',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') +\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-03',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') +\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-04',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') +\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-05',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') +\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-06',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') +\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-07',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') +\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-08',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') +\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-09',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') +\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-10',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') +\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-11',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') +\n" + 
                           "                APPS.CUX_HR_BONUS.GET_PERSON_DIST_AMOUNT(PAPF.PERSON_ID,\n" + 
                           "                                                         '" + 
                           queryYear + "-12',\n" + 
                           "                                                         CBT.TYPE_NAME,\n" + 
                           "                                                         CBPD.DISTRIBUTIONDEP_NAME,\n" + 
                           "                                                         '') AS TOTAL_DIST\n" + 
                           "  FROM APPS.CUX_BONUS_PERSON_DISTRIBUTION CBPD,\n" + 
                           "       APPS.CUX_BONUS_TYPE                CBT,\n" + 
                           "       APPS.CUX_BONUS_ALL_PEOPLE_F_V      PAPF\n" + 
                           " WHERE CBPD.TYPE_ID = CBT.TYPE_ID\n" + 
                           "   AND CBPD.PERSON_ID = PAPF.PERSON_ID\n" + 
                           "   AND PAPF.EMPLOYEE_NUMBER = '" + employeeNumber + 
                           "'\n" + 
                           "   AND CBPD.DISTRIBUTION_DATE BETWEEN TO_DATE('" + 
                           queryYear + "-01-01', 'yyyy-mm-dd') AND\n" + 
                           "       TO_DATE('" + queryYear + 
                           "-12-31', 'yyyy-mm-dd')\n" + 
                           "   AND CBPD.DISTRIBUTION_STATUS = '已批准'\n" + 
                           "   AND CBPD.IMPORT_STATUS <> '已退回'\n" + 
                           " ORDER BY NLSSORT(CBT.TYPE_NAME, 'NLS_SORT=SCHINESE_PINYIN_M')\n");
        //        System.out.println(sbfSQLValue);
        cancelQuery();
        setQuery(sbfSQLValue.toString());
        executeQuery();
    }
}
