package cux.oracle.apps.per.bonus.awardsreport.server;

import oracle.apps.fnd.framework.server.OAViewObjectImpl;
// ---------------------------------------------------------------------
// ---    File generated by Oracle ADF Business Components Design Time.
// ---    Custom code may be added to this class.
// ---    Warning: Do not modify method signatures of generated methods.
// ---------------------------------------------------------------------
public class DeptAwardsVOImpl extends OAViewObjectImpl {
    /**This is the default constructor (do not remove)
     */
    public DeptAwardsVOImpl() {
    }

    public void initSQL(String queryYear) {
        StringBuffer sbfSQLValue = new StringBuffer(1000);
        int tempYear = Integer.parseInt(queryYear);
        String lastYear = String.valueOf(tempYear - 1);
        sbfSQLValue.append("SELECT DISTINCT (CBDD.DEP_NAME),\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_LAST_QUOTA(CBDD.DEP_NAME,\n" + 
                           "                                                      '" + 
                           lastYear + "-12') AS DEPT_INIT_QUOTA,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_QUOTA(CBDD.DEP_NAME,\n" + 
                           "                                                 " + 
                           queryYear + "01,\n" + 
                           "                                                 '月度奖') AS JAN_QUOTA,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_DIST_AMOUNT(CBDD.DEP_NAME,\n" + 
                           "                                                       '" + 
                           queryYear + "-01',\n" + 
                           "                                                       '月度奖') AS JAN_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_QUOTA(CBDD.DEP_NAME,\n" + 
                           "                                                 " + 
                           queryYear + "02,\n" + 
                           "                                                 '月度奖') AS FEB_QUOTA,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_DIST_AMOUNT(CBDD.DEP_NAME,\n" + 
                           "                                                       '" + 
                           queryYear + "-02',\n" + 
                           "                                                       '月度奖') AS FEB_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_QUOTA(CBDD.DEP_NAME,\n" + 
                           "                                                 " + 
                           queryYear + "03,\n" + 
                           "                                                 '月度奖') AS MAR_QUOTA,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_DIST_AMOUNT(CBDD.DEP_NAME,\n" + 
                           "                                                       '" + 
                           queryYear + "-03',\n" + 
                           "                                                       '月度奖') AS MAR_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_QUOTA(CBDD.DEP_NAME,\n" + 
                           "                                                 " + 
                           queryYear + "04,\n" + 
                           "                                                 '月度奖') AS APR_QUOTA,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_DIST_AMOUNT(CBDD.DEP_NAME,\n" + 
                           "                                                       '" + 
                           queryYear + "-04',\n" + 
                           "                                                       '月度奖') AS APR_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_QUOTA(CBDD.DEP_NAME,\n" + 
                           "                                                 " + 
                           queryYear + "05,\n" + 
                           "                                                 '月度奖') AS MAY_QUOTA,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_DIST_AMOUNT(CBDD.DEP_NAME,\n" + 
                           "                                                       '" + 
                           queryYear + "-05',\n" + 
                           "                                                       '月度奖') AS MAY_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_QUOTA(CBDD.DEP_NAME,\n" + 
                           "                                                 " + 
                           queryYear + "06,\n" + 
                           "                                                 '月度奖') AS JUN_QUOTA,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_DIST_AMOUNT(CBDD.DEP_NAME,\n" + 
                           "                                                       '" + 
                           queryYear + "-06',\n" + 
                           "                                                       '月度奖') AS JUN_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_QUOTA(CBDD.DEP_NAME,\n" + 
                           "                                                 " + 
                           queryYear + "07,\n" + 
                           "                                                 '月度奖') AS JUL_QUOTA,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_DIST_AMOUNT(CBDD.DEP_NAME,\n" + 
                           "                                                       '" + 
                           queryYear + "-07',\n" + 
                           "                                                       '月度奖') AS JUL_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_QUOTA(CBDD.DEP_NAME,\n" + 
                           "                                                 " + 
                           queryYear + "08,\n" + 
                           "                                                 '月度奖') AS AUG_QUOTA,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_DIST_AMOUNT(CBDD.DEP_NAME,\n" + 
                           "                                                       '" + 
                           queryYear + "-08',\n" + 
                           "                                                       '月度奖') AS AUG_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_QUOTA(CBDD.DEP_NAME,\n" + 
                           "                                                 " + 
                           queryYear + "09,\n" + 
                           "                                                 '月度奖') AS SEP_QUOTA,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_DIST_AMOUNT(CBDD.DEP_NAME,\n" + 
                           "                                                       '" + 
                           queryYear + "-09',\n" + 
                           "                                                       '月度奖') AS SEP_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_QUOTA(CBDD.DEP_NAME,\n" + 
                           "                                                 " + 
                           queryYear + "10,\n" + 
                           "                                                 '月度奖') AS OCT_QUOTA,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_DIST_AMOUNT(CBDD.DEP_NAME,\n" + 
                           "                                                       '" + 
                           queryYear + "-10',\n" + 
                           "                                                       '月度奖') AS OCT_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_QUOTA(CBDD.DEP_NAME,\n" + 
                           "                                                 " + 
                           queryYear + "11,\n" + 
                           "                                                 '月度奖') AS NOV_QUOTA,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_DIST_AMOUNT(CBDD.DEP_NAME,\n" + 
                           "                                                       '" + 
                           queryYear + "-11',\n" + 
                           "                                                       '月度奖') AS NOV_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_QUOTA(CBDD.DEP_NAME,\n" + 
                           "                                                 " + 
                           queryYear + "12,\n" + 
                           "                                                 '月度奖') AS DEC_QUOTA,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_DIST_AMOUNT(CBDD.DEP_NAME,\n" + 
                           "                                                       '" + 
                           queryYear + "-12',\n" + 
                           "                                                       '月度奖') AS DEC_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_QUOTA(CBDD.DEP_NAME,\n" + 
                           "                                                 " + 
                           queryYear + ",\n" + 
                           "                                                 '年终奖') AS ANNUAL_QUOTA,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_DIST_AMOUNT(CBDD.DEP_NAME,\n" + 
                           "                                                       '" + 
                           queryYear + "',\n" + 
                           "                                                       '年终奖') AS ANNUAL_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_QUOTA(CBDD.DEP_NAME,\n" + 
                           "                                                 " + 
                           queryYear + ",\n" + 
                           "                                                 '总金额') AS TOTAL_QUOTA,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_DIST_AMOUNT(CBDD.DEP_NAME,\n" + 
                           "                                                       '" + 
                           queryYear + "',\n" + 
                           "                                                       '总金额') AS TOTAL_DIST,\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_LAST_QUOTA(CBDD.DEP_NAME,\n" + 
                           "                                                      '" + 
                           lastYear + "-12') +\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_QUOTA(CBDD.DEP_NAME,\n" + 
                           "                                                 " + 
                           queryYear + ",\n" + 
                           "                                                 '总金额') -\n" + 
                           "                APPS.CUX_HR_BONUS.GET_DEPT_DIST_AMOUNT(CBDD.DEP_NAME,\n" + 
                           "                                                       '" + 
                           queryYear + "',\n" + 
                           "                                                       '总金额') DEPT_LAST_QUOTA,\n" + 
                           "                NULL AS DEPT_SELECTION\n" + 
                           "  FROM APPS.CUX_BONUS_DEP_DISTRIBUTION CBDD\n" + 
                           " WHERE CBDD.DISTRIBUTION_STATUS = '已批准'\n" + 
                           "   AND CBDD.DISTRIBUTION_PERIOD BETWEEN " + 
                           queryYear + "01 AND " + queryYear + "12\n" + 
                           " ORDER BY NLSSORT(CBDD.DEP_NAME, 'NLS_SORT=SCHINESE_PINYIN_M')");
        System.out.println(sbfSQLValue);
        cancelQuery();
        setQuery(sbfSQLValue.toString());
        executeQuery();
    }
}
